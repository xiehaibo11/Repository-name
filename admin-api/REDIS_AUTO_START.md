# Redis è‡ªåŠ¨å¯åŠ¨é…ç½®æŒ‡å—

## ğŸ¯ æ¦‚è¿°

ä¸ºäº†è§£å†³ Redis éœ€è¦å•ç‹¬å¯åŠ¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬æä¾›äº†å¤šç§è‡ªåŠ¨åŒ–å¯åŠ¨æ–¹æ¡ˆï¼Œè®©æ‚¨å¯ä»¥ä¸€é”®å¯åŠ¨æ•´ä¸ªå¼€å‘ç¯å¢ƒã€‚

## ğŸš€ å¯åŠ¨æ–¹å¼

### **æ–¹å¼1: ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆæ¨èï¼‰**

#### Windows æ‰¹å¤„ç†æ–‡ä»¶
```bash
# åŒå‡»è¿è¡Œæˆ–åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ
.\start-dev.bat
```

#### PowerShell è„šæœ¬
```powershell
# åœ¨ PowerShell ä¸­è¿è¡Œ
.\start-dev.ps1

# è·³è¿‡ Redis æ£€æŸ¥
.\start-dev.ps1 -SkipRedis

# è¯¦ç»†è¾“å‡º
.\start-dev.ps1 -Verbose
```

### **æ–¹å¼2: ä½¿ç”¨ npm è„šæœ¬**

```bash
# è‡ªåŠ¨å¯åŠ¨ Redis + åç«¯æœåŠ¡
npm run dev:with-redis

# ä½¿ç”¨ concurrently åŒæ—¶è¿è¡Œ
npm run dev:full

# ä»…å¯åŠ¨åç«¯ï¼ˆéœ€è¦æ‰‹åŠ¨å¯åŠ¨ Redisï¼‰
npm run dev
```

### **æ–¹å¼3: ä½¿ç”¨ Node.js è„šæœ¬**

```bash
# æ™ºèƒ½å¯åŠ¨è„šæœ¬
node scripts/start-with-redis.js
```

## âš™ï¸ é…ç½®é€‰é¡¹

### **ç¯å¢ƒå˜é‡é…ç½®**

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```env
# Redis è‡ªåŠ¨å¯åŠ¨ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
REDIS_AUTO_START=true

# Redis è¿æ¥é…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=123456
REDIS_DB=0
REDIS_KEY_PREFIX=admin_api:
```

### **é…ç½®è¯´æ˜**

- `REDIS_AUTO_START=true`: å¯ç”¨ Redis è‡ªåŠ¨å¯åŠ¨
- `REDIS_AUTO_START=false`: ç¦ç”¨ Redis è‡ªåŠ¨å¯åŠ¨ï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨

## ğŸ”§ å·¥ä½œåŸç†

### **è‡ªåŠ¨å¯åŠ¨æµç¨‹**

1. **æ£€æŸ¥ Redis çŠ¶æ€**: ä½¿ç”¨ `redis-cli ping` æ£€æŸ¥ Redis æ˜¯å¦è¿è¡Œ
2. **è‡ªåŠ¨å¯åŠ¨**: å¦‚æœ Redis æœªè¿è¡Œï¼Œè‡ªåŠ¨æ‰§è¡Œ `redis-server redis-dev.conf`
3. **éªŒè¯è¿æ¥**: å¯åŠ¨åéªŒè¯ Redis è¿æ¥æ˜¯å¦æ­£å¸¸
4. **å¯åŠ¨åç«¯**: å¯åŠ¨ Node.js åç«¯æœåŠ¡
5. **ä¼˜é›…å…³é—­**: Ctrl+C æ—¶åŒæ—¶å…³é—­æ‰€æœ‰æœåŠ¡

### **å®¹é”™æœºåˆ¶**

- **Redis å¯åŠ¨å¤±è´¥**: åç«¯æœåŠ¡ä»ä¼šå¯åŠ¨ï¼Œä½†åœ¨æ— ç¼“å­˜æ¨¡å¼ä¸‹è¿è¡Œ
- **è¿æ¥è¶…æ—¶**: 10ç§’è¶…æ—¶åç»§ç»­å¯åŠ¨åç«¯æœåŠ¡
- **è¿›ç¨‹ç®¡ç†**: è‡ªåŠ¨ç®¡ç† Redis è¿›ç¨‹ï¼Œé¿å…é‡å¤å¯åŠ¨

## ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

### **å¼€å‘ç¯å¢ƒå¯åŠ¨**

```bash
# æ–¹æ³•1: ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆæœ€ç®€å•ï¼‰
.\start-dev.bat

# æ–¹æ³•2: ä½¿ç”¨ PowerShell
.\start-dev.ps1

# æ–¹æ³•3: ä½¿ç”¨ npm
npm run dev:with-redis
```

### **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**

```bash
# ç¦ç”¨è‡ªåŠ¨å¯åŠ¨ï¼Œæ‰‹åŠ¨ç®¡ç† Redis
REDIS_AUTO_START=false npm start
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### **å¸¸è§é—®é¢˜**

#### **1. Redis å¯åŠ¨å¤±è´¥**
```
âŒ Redis å¯åŠ¨å¤±è´¥: spawn redis-server ENOENT
```

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿å·²å®‰è£… Redis: `redis-server --version`
- è¿è¡Œå®‰è£…è„šæœ¬: `.\scripts\setup-redis.ps1`

#### **2. ç«¯å£è¢«å ç”¨**
```
âŒ Redis å¯åŠ¨å¤±è´¥: Address already in use
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ç«¯å£å ç”¨: `netstat -ano | findstr :6379`
- åœæ­¢ç°æœ‰ Redis: `redis-cli -a 123456 shutdown`

#### **3. æƒé™é—®é¢˜**
```
âŒ Redis å¯åŠ¨å¤±è´¥: Permission denied
```

**è§£å†³æ–¹æ¡ˆ**:
- ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell
- æ£€æŸ¥æ–‡ä»¶æƒé™

### **æ‰‹åŠ¨æ“ä½œ**

#### **æ‰‹åŠ¨å¯åŠ¨ Redis**
```bash
# å¯åŠ¨ Redis
redis-server redis-dev.conf

# æ£€æŸ¥çŠ¶æ€
redis-cli -a 123456 ping

# åœæ­¢ Redis
redis-cli -a 123456 shutdown
```

#### **æ‰‹åŠ¨å¯åŠ¨åç«¯**
```bash
# å¯åŠ¨åç«¯æœåŠ¡
npm run dev
```

## ğŸ“Š ç›‘æ§å’Œç®¡ç†

### **Redis çŠ¶æ€æ£€æŸ¥**

```bash
# æ£€æŸ¥ Redis çŠ¶æ€
npm run redis:status

# æŸ¥çœ‹ Redis ä¿¡æ¯
redis-cli -a 123456 info server

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
redis-cli -a 123456 info memory
```

### **è¿›ç¨‹ç®¡ç†**

```bash
# æŸ¥çœ‹ Redis è¿›ç¨‹
tasklist | findstr redis

# å¼ºåˆ¶åœæ­¢ Redis
taskkill /f /im redis-server.exe
```

## ğŸ¯ æœ€ä½³å®è·µ

### **å¼€å‘ç¯å¢ƒ**

1. **ä½¿ç”¨è‡ªåŠ¨å¯åŠ¨**: è®¾ç½® `REDIS_AUTO_START=true`
2. **ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶**: æœ€ç®€å•çš„å¯åŠ¨æ–¹å¼
3. **ç›‘æ§æ—¥å¿—**: è§‚å¯Ÿå¯åŠ¨æ—¥å¿—ï¼Œç¡®ä¿æœåŠ¡æ­£å¸¸

### **ç”Ÿäº§ç¯å¢ƒ**

1. **ç¦ç”¨è‡ªåŠ¨å¯åŠ¨**: è®¾ç½® `REDIS_AUTO_START=false`
2. **ç³»ç»ŸæœåŠ¡**: å°† Redis é…ç½®ä¸ºç³»ç»ŸæœåŠ¡
3. **ç›‘æ§å‘Šè­¦**: é…ç½® Redis ç›‘æ§å’Œå‘Šè­¦

### **å›¢é˜Ÿåä½œ**

1. **ç»Ÿä¸€é…ç½®**: å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„ Redis é…ç½®
2. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°é…ç½®æ–‡æ¡£
3. **è„šæœ¬å…±äº«**: å…±äº«å¯åŠ¨è„šæœ¬å’Œé…ç½®æ–‡ä»¶

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `start-dev.bat` - Windows æ‰¹å¤„ç†å¯åŠ¨è„šæœ¬
- `start-dev.ps1` - PowerShell å¯åŠ¨è„šæœ¬
- `scripts/start-with-redis.js` - Node.js æ™ºèƒ½å¯åŠ¨è„šæœ¬
- `src/utils/redisAutoStart.ts` - Redis è‡ªåŠ¨å¯åŠ¨å·¥å…·ç±»
- `redis-dev.conf` - Redis å¼€å‘ç¯å¢ƒé…ç½®
- `.env` - ç¯å¢ƒå˜é‡é…ç½®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. **Redis å®‰è£…**: ç¡®ä¿ Redis å·²æ­£ç¡®å®‰è£…
2. **é…ç½®æ–‡ä»¶**: æ£€æŸ¥ `redis-dev.conf` é…ç½®
3. **ç¯å¢ƒå˜é‡**: éªŒè¯ `.env` æ–‡ä»¶é…ç½®
4. **ç«¯å£å ç”¨**: ç¡®ä¿ 6379 ç«¯å£æœªè¢«å ç”¨
5. **æƒé™é—®é¢˜**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ‰§è¡Œæƒé™

---

**ğŸ‰ ç°åœ¨æ‚¨å¯ä»¥ä¸€é”®å¯åŠ¨æ•´ä¸ªå¼€å‘ç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç† Redisï¼**
